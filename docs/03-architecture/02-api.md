# API

## 1. Сущности
**Изображение (Image)**

| Поле        | Бизнес-описание                                              | Пример значения                                                                                  |
|-------------|--------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| id          | Идентификатор изображения                                    | 1                                                                                                |
| title       | Название                                                     | "Комбат"                                                                                         |
| description | Детальное описание потребности/предложения                   | "фотография времён Великой Отечественной войны, сделанная советским фотографом Максом Альпертом" |
| tags        | массив тэгов. каждый тег - строка                            | "man", "военнослужащий"                                                                          |
| labels      | массив меток. каждая метка это пара ключ-значение            | "autor=Макс Альперт", "original=85-12800, 35 мм негатив"                                         |
| image       | Ссылка на изображение                                        | ../images/36df4909-37b7-4381-8a95-bb0ba387d8d9/5b5a5b43-e30e-4b2d-a39b-2a392321e4d4.jpg     |
| preview     | Ссылка на preview                                            | ../previews/5b5a5b43-e30e-4b2d-a39b-2a392321e4d4.jpg                                             |

**Элемент галереи (ImageItem)**

| Поле        | Бизнес-описание                                        | Пример значения              |
|-------------|--------------------------------------------------------|------------------------------|
| id          | Идентификатор изображения                              | 1                            |
| link        | Ссылка на preview                          | ../previews/32cff40b-9d3d-4639-a961-ece6963bb5e8.jpg |
| title       | Название             | "Солдат, который не хочет воевать ..." |
| tags        | массив тэгов. каждый тег - строка                      | "man", "военнослужащий"      |

## 2. Бизнес-функции (методы)
**CRUDS для изображений**
1. **`import`** - Импорт изображения
   - *Бизнес-правило*: проверка валидности ссылки
   - *Бизнес-правило*: проверка формата загружаемого файла
   - *Ограничения*: Минимальный размер файла до 100 МБ

2. **`read`** - Получение информации об изображении
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)

3. **`link`** - Получение public link на изображение
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)

4. **`download`** - Скачивание изображения
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)

5. **`update`** - Обновление существующего объявления
   - *Бизнес-правило*: Только владелец может изменять объявление (id.owner == visitor)
   - *Бизнес-правило*: Новые теги добавляются в общий список

6. **`delete`** - Удаление изображения
   - *Бизнес-правило*: Только владелец может удалять изображение (id.owner == visitor)

**Работа с галереей**

7. **`list`** - отображение исходной галереи / вывод N изображений (для листания) 
   - *Бизнес-правило*: Реализована пагинация
   - *Бизнес-правило*: Изображения принадлежат владельцу (each(id.owner) == visitor)

8. **`search`** - Поиск объявлений
   - *Бизнес-правило*: Возвращает список найденных изображений по заданным критериям
   - *Бизнес-правило*: Реализована пагинация
   - *Бизнес-правило*: Изображения принадлежат владельцу (each(id.owner) == visitor)

**Специальные методы**
9. **`labels.list`** - Вывод списка возможных меток
   - *Бизнес-правило*: Список меток задает администратор. На уровне MVP - лежит в БД

10. **`tags.list`** - Вывод списка всех тегов пользователя
   - *Бизнес-правило*: Теги создаются автоматически при загрузке, аннотировании или редактировании объекта
   - *Бизнес-правило*: Выводится список тегов для всех изображений

#### 3. Бизнес-правила

1. **Ограничения для preview изображений**:
   - Генерируется предварительно не более 100 previews
   - Preview кэшируются по возможности на клиенте или на nginx
   - Обязательно кэширование previews, которые отображаются при загрузке приложения с целью ускорения загрузки

#### 4. Бизнес-метрики успеха
1. **Скорость поиска изображений**: 95% запросов должны возвращать результаты < 2 сек
2. 
3. 
4. 
5. 
6. **Точность соответствия**: Не менее 90% релевантных предложений для спроса
3. **Конверсия**: 30% просмотров предложений → контакты между компаниями
4. **Ограничения**:
   - Новые пользователи: 10 запросов/минуту
   - Верифицированные компании: 100 запросов/минуту
