# API

## 1. Сущности
**Изображение (Image)**

| Поле        | Бизнес-описание                                              | Пример значения                                                                                  |
|-------------|--------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| id          | Идентификатор изображения                                    | 1                                                                                                |
| title       | Название                                                     | "Комбат"                                                                                         |
| description | Детальное описание потребности/предложения                   | "фотография времён Великой Отечественной войны, сделанная советским фотографом Максом Альпертом" |
| tags        | массив тэгов. каждый тег - строка                            | "man", "военнослужащий"                                                                          |
| labels      | массив меток. каждая метка это пара ключ-значение            | "autor=Макс Альперт", "original=85-12800, 35 мм негатив"                                         |
| image       | Ссылка на изображение                                        | ../images/36df4909-37b7-4381-8a95-bb0ba387d8d9/5b5a5b43-e30e-4b2d-a39b-2a392321e4d4.jpg     |
| preview     | Ссылка на preview                                            | ../previews/5b5a5b43-e30e-4b2d-a39b-2a392321e4d4.jpg                                             |


## 2. Бизнес-функции (методы)
**CRUDS для изображений**
1. **`create`** - Создание изображения и информации о нем
   - *Бизнес-правило*: возможность заполнить название, описание, теги и метки
   - *Бизнес-правило*: проверка валидности ссылки
   - *Бизнес-правило*: проверка формата загружаемого файла
   - *Ограничения*: Минимальный размер файла до 100 МБ
   - *Ограничения*: После создания файл изображения заменить будет нельзя.

2. **`read`** - Получение информации об изображении
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)

3. **`link`** - Получение public link на изображение. Public link не требует авторизации и может быть размещен на маркетплейсе, сайте и т.д.  
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)
   - *Ограничения*: Ссылка, полученная через link является валидной либо в объеме дисковой квоты на публичные изображения для пользователя, либо в течении времени жизни, заданного пользователем

4. **`download`** - Скачивание изображения
   - *Бизнес-правило*: Изображение принадлежит владельцу (id.owner == visitor)

5. **`update`** - Обновление существующего изображения
   - *Бизнес-правило*: Только владелец может изменять объявление (id.owner == visitor)
   - *Бизнес-правило*: Новые теги добавляются в общий список

6. **`delete`** - Удаление изображения
   - *Бизнес-правило*: Только владелец может удалять изображение (id.owner == visitor)

7. **`search`** - Поиск объявлений
   - *Бизнес-правило*: Возвращает список найденных изображений по заданным критериям
   - *Бизнес-правило*: Реализована пагинация
   - *Бизнес-правило*: Изображения принадлежат владельцу (each(id.owner) == visitor)

**Специальные методы**
1. **`labels.list`** - Вывод списка возможных меток. Метки представляют собой элементы метаданных изображений, аналогично EXIF, IPTC. Список расширяется только от версии к версии продукта (при расширении стандартов хранения изображений)
   - *Бизнес-правило*: Редактирование списка меток (Create, Update, Delete) выполняет администратор. На уровне MVP - задаются записями в БД

2. **`tags.list`** - Вывод списка всех тегов пользователя
   - *Бизнес-правило*: Теги создаются вручную или автоматически при загрузке, аннотировании или редактировании объекта
   - *Бизнес-правило*: Выводится список тегов для всех изображений, принадлежащих пользователю
   - *Бизнес-правило*: Create/Delete - в момент создания, или обновления изображения пользователь добавляет или удаляет новую строку в/из список(а) тегов
   - *Бизнес-правило*: Редактирование тега не предусмотрено

#### 3. Бизнес-правила

1. **Ограничения для preview изображений**:
   - Генерируется предварительно не более 100 previews
   - Preview кэшируются по возможности на клиенте или на nginx
   - Обязательно кэширование previews, которые отображаются при загрузке приложения с целью ускорения загрузки

#### 4. Бизнес-метрики успеха
1. **Скорость поиска изображений**: 95% запросов должны возвращать результаты < 2 сек
6. **Точность соответствия**: *TBD* 
3. **Конверсия**: *TBD*
4. **Ограничения**: *TBD*

